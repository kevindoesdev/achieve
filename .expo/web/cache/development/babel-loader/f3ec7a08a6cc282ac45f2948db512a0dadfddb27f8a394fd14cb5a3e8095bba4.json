{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { TextInput as PaperTextInput } from \"react-native-paper\";\nimport { useState, useRef } from \"react\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar FocusBlur = function (FocusBlur) {\n  FocusBlur[\"Idle\"] = \"idle\";\n  FocusBlur[\"Focus\"] = \"focus\";\n  FocusBlur[\"Blur\"] = \"blur\";\n  return FocusBlur;\n}(FocusBlur || {});\nexport var TextInput = function TextInput(_ref) {\n  var placeholder = _ref.placeholder,\n    text = _ref.text,\n    _onChangeText = _ref.onChangeText,\n    onEndEditing = _ref.onEndEditing;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    editing = _useState2[0],\n    _setEditing = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    valueSnapshot = _useState4[0],\n    setValueSnapshot = _useState4[1];\n  var _useState5 = useState(text),\n    _useState6 = _slicedToArray(_useState5, 2),\n    value = _useState6[0],\n    setValue = _useState6[1];\n  var inputRef = useRef(null);\n  var setEditing = function setEditing(state) {\n    console.log('setEditing', state);\n    _setEditing(state);\n  };\n  var _useState7 = useState(FocusBlur.Idle),\n    _useState8 = _slicedToArray(_useState7, 2),\n    debounceFocusBlur = _useState8[0],\n    setDebounceFocusBlur = _useState8[1];\n  var completeFocusBlur = function completeFocusBlur() {\n    setEditing(debounceFocusBlur === FocusBlur.Focus);\n    if (debounceFocusBlur === FocusBlur.Blur) {\n      onEndEditing(value);\n    } else if (debounceFocusBlur === FocusBlur.Focus) {\n      setValueSnapshot(value);\n    }\n    setDebounceFocusBlur(FocusBlur.Idle);\n  };\n  var setFocusBlur = function setFocusBlur(state) {\n    console.log('setFocusBlur', state);\n    if (debounceFocusBlur === FocusBlur.Idle && state !== FocusBlur.Idle) {\n      setDebounceFocusBlur(state);\n      setTimeout(completeFocusBlur, 1);\n    }\n  };\n  var startEditing = function startEditing() {\n    setFocusBlur(FocusBlur.Focus);\n  };\n  var endEditing = function endEditing() {\n    setFocusBlur(FocusBlur.Blur);\n  };\n  return _jsx(PaperTextInput, {\n    placeholder: placeholder,\n    value: value,\n    mode: \"outlined\",\n    ref: inputRef,\n    outlineStyle: {\n      borderWidth: 0\n    },\n    style: {\n      backgroundColor: \"rgba(0, 0, 0, 0.0)\",\n      fontSize: 20\n    },\n    onFocus: function onFocus() {\n      console.log('onFocus');\n      startEditing();\n    },\n    onBlur: function onBlur() {\n      console.log('onBlur');\n      setEditing(false);\n      onEndEditing(value);\n    },\n    onChangeText: function onChangeText(text) {\n      console.log('onChangeText');\n      setValue(text);\n      _onChangeText(text);\n    },\n    onEndEditing: function onEndEditing() {\n      console.log('onEndEditing');\n      endEditing();\n    },\n    left: _jsx(PaperTextInput.Icon, {\n      style: {\n        top: -8\n      },\n      icon: editing ? \"close\" : \"pencil\",\n      forceTextInputFocus: false,\n      onPress: editing ? function () {\n        console.log('onPress.blur');\n        setValue(valueSnapshot);\n        inputRef.current.blur();\n        endEditing();\n      } : function () {\n        console.log('onPress.focus');\n        inputRef.current.focus();\n      }\n    })\n  });\n};\nTextInput.defaultProps = {\n  onChangeText: function onChangeText() {},\n  onEndEditing: function onEndEditing() {}\n};\nexport default TextInput;","map":{"version":3,"names":["TextInput","PaperTextInput","useState","useRef","jsx","_jsx","FocusBlur","_ref","placeholder","text","onChangeText","onEndEditing","_useState","_useState2","_slicedToArray","editing","_setEditing","_useState3","_useState4","valueSnapshot","setValueSnapshot","_useState5","_useState6","value","setValue","inputRef","setEditing","state","console","log","_useState7","Idle","_useState8","debounceFocusBlur","setDebounceFocusBlur","completeFocusBlur","Focus","Blur","setFocusBlur","setTimeout","startEditing","endEditing","mode","ref","outlineStyle","borderWidth","style","backgroundColor","fontSize","onFocus","onBlur","left","Icon","top","icon","forceTextInputFocus","onPress","current","blur","focus","defaultProps"],"sources":["/home/rocket/git/achieve/src/components/TextInput.tsx"],"sourcesContent":["import { TextInput as PaperTextInput } from \"react-native-paper\";\nimport { TextInput as RNTextInput } from \"react-native\";\nimport { useState, useRef } from \"react\";\n\ninterface Props {\n  placeholder?: string,\n  text: string,\n  onChangeText: (text: string) => void,\n  onEndEditing: (text: string) => void\n}\n\nenum FocusBlur {\n  Idle = 'idle',\n  Focus = 'focus',\n  Blur = 'blur'\n}\n\nexport const TextInput = ({ placeholder, text, onChangeText, onEndEditing }: Props) => {\n  const [editing, _setEditing] = useState(false);\n  const [valueSnapshot, setValueSnapshot] = useState('');\n  const [value, setValue] = useState(text);\n  const inputRef = useRef<RNTextInput>(null);\n\n  const setEditing = (state: boolean) => {\n    console.log('setEditing', state);\n    _setEditing(state)\n  }\n\n  const [debounceFocusBlur, setDebounceFocusBlur] = useState(FocusBlur.Idle);\n\n  const completeFocusBlur = () => {\n    setEditing(debounceFocusBlur === FocusBlur.Focus);\n    if (debounceFocusBlur === FocusBlur.Blur) {\n      onEndEditing(value);\n    } else if (debounceFocusBlur === FocusBlur.Focus) {\n      setValueSnapshot(value);\n    }\n    setDebounceFocusBlur(FocusBlur.Idle);\n  }\n  \n  const setFocusBlur = (state: FocusBlur) => {\n    console.log('setFocusBlur', state)\n    if (debounceFocusBlur === FocusBlur.Idle && state !== FocusBlur.Idle) {\n      setDebounceFocusBlur(state);\n      setTimeout(completeFocusBlur, 1)\n    }\n  }\n  \n  const startEditing = () => {\n    setFocusBlur(FocusBlur.Focus)\n  }\n\n  const endEditing = () => {\n    setFocusBlur(FocusBlur.Blur)\n  }\n\n  return (\n    <PaperTextInput\n      placeholder={placeholder}\n      value={value}\n      mode=\"outlined\"\n      ref={inputRef}\n      outlineStyle={{ borderWidth: 0 }}\n      style={{\n        backgroundColor: \"rgba(0, 0, 0, 0.0)\",\n        fontSize: 20,\n      }}\n      onFocus={() => {\n        console.log('onFocus');\n        startEditing();\n      }}\n      onBlur={() => {\n        console.log('onBlur');\n        setEditing(false);\n        onEndEditing(value);\n      }}\n      onChangeText={(text) => {\n        console.log('onChangeText');\n        setValue(text);\n        onChangeText(text);\n      }}\n      onEndEditing={() => {\n        console.log('onEndEditing')\n        endEditing();\n      }}\n      left={\n        <PaperTextInput.Icon\n          style={{ top: -8 }}\n          icon={editing ? \"close\" : \"pencil\"}\n          forceTextInputFocus={false}\n          onPress={\n            editing ? () => {\n            \n              console.log('onPress.blur');\n              setValue(valueSnapshot);\n              (inputRef as any).current.blur()\n              endEditing();\n            } : () => {\n              console.log('onPress.focus');\n              (inputRef as any).current.focus()\n            }\n          }\n        />\n      }\n    />\n  );\n};\n\nTextInput.defaultProps = {\n  onChangeText: () => {},\n  onEndEditing: () => {},\n};\n\nexport default TextInput;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}